1. Check that iommu is enabled in motherboard bios and check that your GPU kernal is vfio-pci, you can check bu running:
 - lspci (find your GPU "ID", ex: 08:00)
 - lspci -n -s 08:00 -v, look for "Kernal driver in use:" (This should say vfio-pci)
 - If not whatch this (https://www.youtube.com/watch?v=_hOBAGKLQkI)
2. Create a new VM 
Sepcs:
Os: Ubuntu 24 LTS
Machine: q35
Bios: OVMF (UEFI)
HD: 400gb (ssd emulation on)
Ram: 32gb (Balloon=0)
Processors: 12 cores
3. Start and setup ubuntu init (be sure to create the ubuntu disk to be the full 400gb, this is in the storage configuration step) (https://www.youtube.com/watch?v=n7aEcfDNULc)
4. Add ssh publick keys and diable password auth
5. change password
6. shutdown system 
7. add PCI device in proxmox, select "Raw Device", your GPU and "All Functions"
8. Start vm and ssh in to it
9. Install nvidia drivers run:
 - sudo ubuntu-drivers install
10. Reboot system
11. Run nvida-smi and see if you see you GPU. If you do good it is working. Else: not good.
12. Install Docker compose run:
 - sudo apt-get update && sudo apt-get install ca-certificates curl && sudo install -m 0755 -d /etc/apt/keyrings && sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc && sudo chmod a+r /etc/apt/keyrings/docker.asc && echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null && sudo apt-get update && sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
13. Install nvidia docker toolkit: (https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html) (https://technotim.live/posts/ai-stack-tutorial/): 
 - curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg && curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list && sudo apt-get update && sudo apt-get install -y nvidia-container-toolkit && sudo nvidia-ctk runtime configure --runtime=docker && sudo systemctl restart docker
14. Test by running: (if nvidia-smi shows up good then it works)
 - sudo docker run --rm --runtime=nvidia --gpus all ubuntu nvidia-smi
15. Copy ai-stack and folder with compose file and all and spin it up with:
 - sudo docker compose up -d --build --remove-orphans
