# ForwardAuth with traefik
## First:
- Go to Applications: Outposts
- Click edit button on authentik Embedded Outpost
- Open Advanced settings
- Make sure that authentik_host: https://auth.local.jabbas.dev
- Click Update

## Adding a new connection
1. add authentik-foarwardauth middleware in traefik conf
2. go to authentk and create a new application and provider for the service
The things you need to fill in:
 - Application Name: Service name (ex: sonarr)
 - Slug: Service name (ex: sonarr)
 - provider type: Proxy Provider
 - Proiver name: "Provider for <Service name> (ex: Provider for sonarr)
 - Authorization flow: default-provider-authorization-implicit-consent
 - Chose Forward Auth (Single Application) in the selection
 - External host: https://<service>.local.jabbas.dev
 (if homepage dashboard or something else need access to api or some specific path that cant be behinde authentik do this):
 - Under advancded protocol settings, Unauthenticated Paths: set to the path you need (one path per line) (ex: ^/api/.*) (this is to give access to api)
 (if the service has basic auth as a authentication method do this):
 - Under Authentication settings: Enable "Send HTTP-Basic Authentication"
 - HTTP-Basic Username key: <service>_username
 - HTTP-Basic Password key: <service>_password
 - Save
 - Then go to Directory/Groups and create a new group called <service>_access
 - Under attributes make the first line: <service>_username: <username>
 - Make the second line to: <service>_password: <password>
 - Save the group
 - Then click on the newly created group, then go to users and click "Add existing user"
 - Add the user that you want to have access to the service
3. go to Applications/Outpost
- Edit the authentik Embedded Outpost
- Add the new service by doubble taping it 
- Click Update
3. Done!